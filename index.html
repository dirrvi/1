<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Тестування</title>
<style>
  body { font-family: Arial, sans-serif; max-width: 800px; margin: 20px auto; padding: 0 10px; }
  h1,h2,h3 { text-align: center; }
  .hidden { display: none; }
  button { padding: 10px 15px; margin: 10px 5px; cursor: pointer; }
  .tab-buttons { text-align: center; margin-bottom: 10px; }
  .tab-buttons button { margin: 0 5px; }
  .tab-content { border: 1px solid #ccc; padding: 15px; min-height: 250px; }
  table { width: 100%; border-collapse: collapse; margin-top: 15px; }
  table, th, td { border: 1px solid #ccc; }
  th, td { padding: 10px; text-align: center; }
  .green-bg { background-color: #d4edda; }
  .confirm-overlay {
    position: fixed; top:0; left:0; width:100%; height:100%;
    background: rgba(0,0,0,0.5);
    display:flex; justify-content:center; align-items:center;
    z-index: 1000;
  }
  .confirm-box {
    background: white; padding: 20px; border-radius: 6px;
    max-width: 300px; text-align: center;
  }
</style>
</head>
<body>

<!-- СТАРТОВА СТРАНИЦА С ПРАВИЛАМИ -->
<div id="page-start">
  <h1>Правила тестування</h1>
  <p>Вітаємо! Перед початком тестування ознайомтесь з правилами:</p>
  <ul>
    <li>Тест складається з 4 предметів, розділених на 2 блоки.</li>
    <li>Перший блок: Українська мова та Математика.</li>
    <li>Другий блок: Історія України та Англійська мова.</li>
    <li>Відповідайте на питання уважно.</li>
  </ul>
  <button id="btn-accept-rules">З правилами ознайомився/лась</button>
</div>

<!-- ПЕРЕХОД К ПЕРВОМУ БЛОКУ - ВВОД КОДА ДОСТУПА -->
<div id="page-block1-code" class="hidden">
  <h2>Введіть код доступу для першого блоку</h2>
  <input type="password" id="input-code-block1" placeholder="Код доступу" />
  <br />
  <button id="btn-start-block1" disabled>Розпочати роботу над тестуванням</button>
  <p id="error-code-block1" style="color:red;"></p>
</div>

<!-- ПЕРЕХОД К ТЕСТУ ПЕРВОГО БЛОКА -->
<div id="page-block1-test" class="hidden">
  <h2>Перший блок тестування</h2>
  <div class="tab-buttons">
    <button class="tab-btn" data-subject="ukr">Українська мова</button>
    <button class="tab-btn" data-subject="math">Математика</button>
  </div>
  <div id="ukr" class="tab-content"></div>
  <div id="math" class="tab-content hidden"></div>
  <button id="btn-finish-block1">Завершити тестування</button>
</div>

<!-- ПОДТВЕРЖДЕНИЕ ЗАВЕРШЕНИЯ БЛОКА -->
<div id="confirm-finish-block1" class="confirm-overlay hidden">
  <div class="confirm-box">
    <p>Ви точно хочете завершити роботу над тестуванням?</p>
    <button id="confirm-yes-block1">Так</button>
    <button id="confirm-no-block1">Ні</button>
  </div>
</div>

<!-- РЕЗУЛЬТАТЫ ПЕРВОГО БЛОКА -->
<div id="page-block1-result" class="hidden">
  <h2>Результати першого блоку</h2>
  <table>
    <thead>
      <tr><th>Предмет</th><th>Відповіді</th><th></th></tr>
    </thead>
    <tbody>
      <tr><td>Українська мова</td><td id="result-ukr"></td><td></td></tr>
      <tr><td>Математика</td><td id="result-math"></td><td></td></tr>
    </tbody>
  </table>
  <button id="btn-go-block2">Перейти до 2 блоку</button>
</div>

<!-- ПЕРЕХОД К КОДУ ВТОРОГО БЛОКА -->
<div id="page-block2-code" class="hidden">
  <h2>Введіть код доступу для другого блоку</h2>
  <input type="password" id="input-code-block2" placeholder="Код доступу" />
  <br />
  <button id="btn-start-block2" disabled>Розпочати роботу над тестуванням</button>
  <p id="error-code-block2" style="color:red;"></p>
</div>

<!-- ТЕСТ ВТОРОГО БЛОКА -->
<div id="page-block2-test" class="hidden">
  <h2>Другий блок тестування</h2>
  <div class="tab-buttons">
    <button class="tab-btn" data-subject="history">Історія України</button>
    <button class="tab-btn" data-subject="eng">Англійська мова</button>
  </div>
  <div id="history" class="tab-content"></div>
  <div id="eng" class="tab-content hidden"></div>
  <button id="btn-finish-block2">Завершити тестування</button>
</div>

<!-- ПОДТВЕРЖДЕНИЕ ЗАВЕРШЕНИЯ ВТОРОГО БЛОКА -->
<div id="confirm-finish-block2" class="confirm-overlay hidden">
  <div class="confirm-box">
    <p>Ви точно хочете завершити роботу над тестуванням?</p>
    <button id="confirm-yes-block2">Так</button>
    <button id="confirm-no-block2">Ні</button>
  </div>
</div>

<!-- РЕЗУЛЬТАТЫ ВТОРОГО БЛОКА И ВСЕГО ТЕСТА -->
<div id="page-block2-result" class="hidden">
  <h2>Результати тестування</h2>
  <table>
    <thead>
      <tr><th>Предмет</th><th>Відповіді</th><th>Бал</th></tr>
    </thead>
    <tbody>
      <tr><td>Українська мова</td><td id="res-ukr"></td><td id="score-ukr" class=""></td></tr>
      <tr><td>Математика</td><td id="res-math"></td><td id="score-math" class=""></td></tr>
      <tr><td>Історія України</td><td id="res-history"></td><td id="score-history" class="green-bg"></td></tr>
      <tr><td>Англійська мова</td><td id="res-eng"></td><td id="score-eng" class="green-bg"></td></tr>
    </tbody>
  </table>
  <button id="btn-view-answers">Переглянути відповіді</button>
</div>

<!-- ПРОСМОТР ОТВЕТОВ -->
<div id="page-answers" class="hidden">
  <h2>Відповіді за всіма предметами</h2>
  <div id="all-answers"></div>
  <button id="btn-restart">Почати заново</button>
</div>

<script>
(() => {
  // Вопросы для каждого предмета, по 12 вопросов
  const questions = {
    ukr: [
      {q: "Яка частина мови означає предмет?", options: ["Іменник", "Дієслово", "Прикметник", "Прислівник"], a: 0},
      {q: "Виберіть правильний варіант: «Я ____ в школу»", options: ["йду", "йде", "йдеш", "йдуть"], a: 0},
      {q: "Який знак ставиться в кінці речення-питання?", options: ["?", "!", ".", ","], a: 0},
      {q: "Скільки голосних у слові «мова»?", options: ["2", "3", "4", "1"], a: 1},
      {q: "Визначте частину мови слова «бігти»", options: ["Іменник", "Дієслово", "Прикметник", "Прислівник"], a: 1},
      {q: "Що таке синонім?", options: ["Протилежне слово", "Схоже за значенням слово", "Однокореневе слово", "Інше слово"], a: 1},
      {q: "Виберіть правильне речення:", options: ["Я йду додому", "Я йду додом", "Я йду додомо", "Я йду додуми"], a: 0},
      {q: "Який рід у слова «сонце»?", options: ["Чоловічий", "Жіночий", "Середній", "Неозначений"], a: 2},
      {q: "Яка частина мови відповідає на питання 'як?'", options: ["Іменник", "Дієслово", "Прикметник", "Прислівник"], a: 3},
      {q: "Виберіть прислівник:", options: ["Швидко", "Швидкий", "Швидкість", "Швидшати"], a: 0},
      {q: "Як правильно написати: «їхати» чи «їхать»?", options: ["їхати", "їхать", "обидва варіанти", "жоден варіант"], a: 0},
      {q: "Виберіть слово з великої літери:", options: ["Україна", "місто", "річка", "дерево"], a: 0}
    ],
    math: [
      {q: "Скільки буде 2 + 3?", options: ["4", "5", "6", "7"], a: 1},
      {q: "Який результат множення 4 на 3?", options: ["7", "10", "12", "9"], a: 2},
      {q: "Що таке квадрат числа 5?", options: ["10", "15", "25", "20"], a: 2},
      {q: "Яке число є парним?", options: ["3", "5", "8", "7"], a: 2},
      {q: "Скільки кутів у трикутника?", options: ["3", "4", "5", "6"], a: 0},
      {q: "Яке число йде після 9?", options: ["8", "10", "11", "9"], a: 1},
      {q: "Що таке сума чисел 7 і 2?", options: ["8", "9", "10", "7"], a: 1},
      {q: "Яка цифра в числі 123 стоїть у розряді десятків?", options: ["1", "2", "3", "4"], a: 1},
      {q: "Який результат віднімання 10 - 4?", options: ["5", "6", "7", "4"], a: 1},
      {q: "Скільки сторін у квадрата?", options: ["3", "4", "5", "6"], a: 1},
      {q: "Що таке добуток?", options: ["Сума", "Віднімання", "Множення", "Ділення"], a: 2},
      {q: "Як називається число, яке ділить інше на рівні частини?", options: ["Дільник", "Ділене", "Добуток", "Різниця"], a: 0}
    ],
    history: [
      {q: "Коли була заснована Київська Русь?", options: ["9 століття", "10 століття", "11 століття", "12 століття"], a: 0},
      {q: "Хто був першим президентом України?", options: ["Кравчук", "Ющенко", "Янукович", "Порошенко"], a: 0},
      {q: "Яка війна відбулась у 1941-1945 роках?", options: ["Перша світова", "Друга світова", "Громадянська", "Холодна"], a: 1},
      {q: "Що таке Козаччина?", options: ["Соціальний рух", "Історична епоха", "Група людей", "Місто"], a: 1},
      {q: "Хто був Богдан Хмельницький?", options: ["Козацький гетьман", "Поет", "Президент", "Воїн"], a: 0},
      {q: "Яка столиця України?", options: ["Львів", "Київ", "Одеса", "Харків"], a: 1},
      {q: "Що таке Майдан?", options: ["Площа", "Вулиця", "Річка", "Гора"], a: 0},
      {q: "Яка держава панувала в Україні у 19 столітті?", options: ["Російська імперія", "Османська імперія", "Австро-Угорщина", "Польща"], a: 0},
      {q: "Коли відбулась Незалежність України?", options: ["1990", "1991", "1992", "1993"], a: 1},
      {q: "Хто є автором Конституції України?", options: ["Верховна Рада", "Президент", "Кабінет Міністрів", "Прем'єр-міністр"], a: 0},
      {q: "Що таке Голодомор?", options: ["Голод", "Війна", "Повінь", "Землетрус"], a: 0},
      {q: "Яка релігія найбільш поширена в Україні?", options: ["Православ'я", "Католицизм", "Іслам", "Буддизм"], a: 0}
    ],
    eng: [
      {q: "What is the English word for 'друг'?", options: ["Friend", "Enemy", "Teacher", "Student"], a: 0},
      {q: "Choose the correct verb: 'She ____ to school every day.'", options: ["go", "goes", "going", "gone"], a: 1},
      {q: "What color is the sky?", options: ["Green", "Blue", "Red", "Yellow"], a: 1},
      {q: "What is the opposite of 'big'?", options: ["Small", "Tall", "Fast", "Slow"], a: 0},
      {q: "Complete the sentence: 'I ___ an apple.'", options: ["eat", "eats", "eating", "ate"], a: 0},
      {q: "Which word is a noun?", options: ["Run", "Quickly", "Apple", "Blue"], a: 2},
      {q: "Choose the correct pronoun: 'This is ___ book.'", options: ["my", "me", "mine", "I"], a: 0},
      {q: "What is the past tense of 'go'?", options: ["goed", "went", "goes", "gone"], a: 1},
      {q: "How do you say 'доброго ранку' in English?", options: ["Good night", "Good morning", "Good afternoon", "Hello"], a: 1},
      {q: "Which word is an adjective?", options: ["Run", "Happy", "Quickly", "Dog"], a: 1},
      {q: "What is the plural form of 'child'?", options: ["Childs", "Childes", "Children", "Child"], a: 2},
      {q: "Choose the correct article: 'I saw ___ elephant.'", options: ["a", "an", "the", "no article"], a: 1}
    ]
  };

  // Хранение ответов ученика - структура {ukr: [], math: [], history: [], eng: []}
  const answers = {
    ukr: new Array(12).fill(null),
    math: new Array(12).fill(null),
    history: new Array(12).fill(null),
    eng: new Array(12).fill(null)
  };

  // Переменные состояния
  let currentPage = "start";
  let currentBlock = 1; // 1 или 2
  let currentSubject = "ukr"; // текущий таб
  const codeBlock1 = "54";
  const codeBlock2 = "29";

  // Элементы
  const pageStart = document.getElementById("page-start");
  const btnAcceptRules = document.getElementById("btn-accept-rules");

  const pageBlock1Code = document.getElementById("page-block1-code");
  const inputCodeBlock1 = document.getElementById("input-code-block1");
  const btnStartBlock1 = document.getElementById("btn-start-block1");
  const errorCodeBlock1 = document.getElementById("error-code-block1");

  const pageBlock1Test = document.getElementById("page-block1-test");
  const tabButtonsBlock1 = pageBlock1Test.querySelectorAll(".tab-btn");
  const ukrDiv = document.getElementById("ukr");
  const mathDiv = document.getElementById("math");
  const btnFinishBlock1 = document.getElementById("btn-finish-block1");

  const confirmFinishBlock1 = document.getElementById("confirm-finish-block1");
  const confirmYesBlock1 = document.getElementById("confirm-yes-block1");
  const confirmNoBlock1 = document.getElementById("confirm-no-block1");

  const pageBlock1Result = document.getElementById("page-block1-result");
  const resultUkr = document.getElementById("result-ukr");
  const resultMath = document.getElementById("result-math");
  const btnGoBlock2 = document.getElementById("btn-go-block2");

  const pageBlock2Code = document.getElementById("page-block2-code");
  const inputCodeBlock2 = document.getElementById("input-code-block2");
  const btnStartBlock2 = document.getElementById("btn-start-block2");
  const errorCodeBlock2 = document.getElementById("error-code-block2");

  const pageBlock2Test = document.getElementById("page-block2-test");
  const tabButtonsBlock2 = pageBlock2Test.querySelectorAll(".tab-btn");
  const historyDiv = document.getElementById("history");
  const engDiv = document.getElementById("eng");
  const btnFinishBlock2 = document.getElementById("btn-finish-block2");

  const confirmFinishBlock2 = document.getElementById("confirm-finish-block2");
  const confirmYesBlock2 = document.getElementById("confirm-yes-block2");
  const confirmNoBlock2 = document.getElementById("confirm-no-block2");

  const pageBlock2Result = document.getElementById("page-block2-result");
  const resUkr = document.getElementById("res-ukr");
  const resMath = document.getElementById("res-math");
  const resHistory = document.getElementById("res-history");
  const resEng = document.getElementById("res-eng");
  const scoreUkr = document.getElementById("score-ukr");
  const scoreMath = document.getElementById("score-math");
  const scoreHistory = document.getElementById("score-history");
  const scoreEng = document.getElementById("score-eng");
  const btnViewAnswers = document.getElementById("btn-view-answers");

  const pageAnswers = document.getElementById("page-answers");
  const allAnswersDiv = document.getElementById("all-answers");
  const btnRestart = document.getElementById("btn-restart");

  // Показывает страницу, скрывая все остальные
  function showPage(page) {
    currentPage = page;
    const pages = [
      pageStart,
      pageBlock1Code,
      pageBlock1Test,
      pageBlock1Result,
      pageBlock2Code,
      pageBlock2Test,
      pageBlock2Result,
      pageAnswers
    ];
    pages.forEach(p => p.classList.add("hidden"));
    switch(page) {
      case "start": pageStart.classList.remove("hidden"); break;
      case "block1code": pageBlock1Code.classList.remove("hidden"); break;
      case "block1test": pageBlock1Test.classList.remove("hidden"); break;
      case "block1result": pageBlock1Result.classList.remove("hidden"); break;
      case "block2code": pageBlock2Code.classList.remove("hidden"); break;
      case "block2test": pageBlock2Test.classList.remove("hidden"); break;
      case "block2result": pageBlock2Result.classList.remove("hidden"); break;
      case "answers": pageAnswers.classList.remove("hidden"); break;
    }
  }

  // Рендер вопросов в заданном div и subject
  function renderQuestions(subject, container) {
    const qs = questions[subject];
    container.innerHTML = "";
    qs.forEach((item, i) => {
      const div = document.createElement("div");
      div.style.marginBottom = "10px";
      const qText = document.createElement("p");
      qText.textContent = (i+1) + ". " + item.q;
      div.appendChild(qText);
      item.options.forEach((opt, idx) => {
        const label = document.createElement("label");
        label.style.display = "block";
        const input = document.createElement("input");
        input.type = "radio";
        input.name = `${subject}-q${i}`;
        input.value = idx;
        if(answers[subject][i] === idx) input.checked = true;
        input.addEventListener("change", () => {
          answers[subject][i] = idx;
        });
        label.appendChild(input);
        label.appendChild(document.createTextNode(" " + opt));
        div.appendChild(label);
      });
      container.appendChild(div);
    });
  }

  // Переключение табов
  function setupTabs(tabButtons, containers) {
    tabButtons.forEach(btn => {
      btn.addEventListener("click", () => {
        const sub = btn.dataset.subject;
        tabButtons.forEach(b => b.disabled = false);
        btn.disabled = true;
        containers.forEach(c => c.classList.add("hidden"));
        document.getElementById(sub).classList.remove("hidden");
        currentSubject = sub;
      });
    });
  }

  // Подсчёт сколько ответов даны
  function countAnswered(arr) {
    return arr.filter(a => a !== null).length;
  }

  // Подсчёт баллов (кол-во правильных)
  function countScore(subject) {
    return answers[subject].reduce((sum, ans, i) => {
      if(ans === questions[subject][i].a) return sum + 1;
      return sum;
    }, 0);
  }

  // Вывести таблицу результатов первого блока
  function showResultsBlock1() {
    resultUkr.textContent = countAnswered(answers.ukr) + " / 12";
    resultMath.textContent = countAnswered(answers.math) + " / 12";
  }

  // Вывести таблицу результатов второго блока и суммарные баллы
  function showResultsBlock2() {
    resUkr.textContent = countAnswered(answers.ukr) + " / 12";
    resMath.textContent = countAnswered(answers.math) + " / 12";
    resHistory.textContent = countAnswered(answers.history) + " / 12";
    resEng.textContent = countAnswered(answers.eng) + " / 12";

    scoreUkr.textContent = countScore("ukr") + " / 12";
    scoreMath.textContent = countScore("math") + " / 12";
    scoreHistory.textContent = countScore("history") + " / 12";
    scoreEng.textContent = countScore("eng") + " / 12";
  }

  // Показываем все вопросы и ответы для просмотра
  function showAllAnswers() {
    allAnswersDiv.innerHTML = "";
    for(const subj of ["ukr","math","history","eng"]) {
      const div = document.createElement("div");
      div.style.marginBottom = "25px";
      const h3 = document.createElement("h3");
      let name = "";
      switch(subj) {
        case "ukr": name = "Українська мова"; break;
        case "math": name = "Математика"; break;
        case "history": name = "Історія України"; break;
        case "eng": name = "Англійська мова"; break;
      }
      h3.textContent = name;
      div.appendChild(h3);
      questions[subj].forEach((q,i) => {
        const p = document.createElement("p");
        const userAnswer = answers[subj][i];
        let userAnswerText = userAnswer === null ? "Не відповіли" : q.options[userAnswer];
        const correctAnswerText = q.options[q.a];
        const isCorrect = userAnswer === q.a;
        p.innerHTML = `<b>${i+1}. ${q.q}</b><br>
          Ваш відповідь: <span style="color:${isCorrect ? "green" : "red"}">${userAnswerText}</span><br>
          Правильна відповідь: ${correctAnswerText}`;
        div.appendChild(p);
      });
      allAnswersDiv.appendChild(div);
    }
  }

  // Инициализация страниц и обработчиков

  // С стартовой страницы
  btnAcceptRules.addEventListener("click", () => {
    btnAcceptRules.disabled = true;
    // Показываем кнопку "Перейти до першого блоку" вместо её же
    pageStart.innerHTML = `
      <h1>Правила тестування</h1>
      <p>Вітаємо! Перед початком тестування ознайомтесь з правилами:</p>
      <ul>
        <li>Тест складається з 4 предметів, розділених на 2 блоки.</li>
        <li>Перший блок: Українська мова та Математика.</li>
        <li>Другий блок: Історія України та Англійська мова.</li>
        <li>Відповідайте на питання уважно.</li>
      </ul>
      <button id="btn-go-block1">Перейти до першого блоку</button>
    `;
    document.getElementById("btn-go-block1").addEventListener("click", () => {
      showPage("block1code");
    });
  });

  // Код доступа первый блок
  inputCodeBlock1.addEventListener("input", () => {
    if(inputCodeBlock1.value.trim() === codeBlock1) {
      btnStartBlock1.disabled = false;
      errorCodeBlock1.textContent = "";
    } else {
      btnStartBlock1.disabled = true;
    }
  });

  btnStartBlock1.addEventListener("click", () => {
    if(inputCodeBlock1.value.trim() === codeBlock1) {
      errorCodeBlock1.textContent = "";
      showPage("block1test");
      // Рендерим вопросы первого блока
      renderQuestions("ukr", ukrDiv);
      renderQuestions("math", mathDiv);
      // Настраиваем табы первого блока
      setupTabs(tabButtonsBlock1, [ukrDiv, mathDiv]);
      // По умолчанию показываем укр
      tabButtonsBlock1.forEach(b => b.disabled = false);
      tabButtonsBlock1[0].disabled = true;
      ukrDiv.classList.remove("hidden");
      mathDiv.classList.add("hidden");
      currentSubject = "ukr";
    } else {
      errorCodeBlock1.textContent = "Невірний код доступу";
    }
  });

  // Завершить тестирование первого блока
  btnFinishBlock1.addEventListener("click", () => {
    confirmFinishBlock1.classList.remove("hidden");
  });

  confirmNoBlock1.addEventListener("click", () => {
    confirmFinishBlock1.classList.add("hidden");
  });

  confirmYesBlock1.addEventListener("click", () => {
    confirmFinishBlock1.classList.add("hidden");
    showResultsBlock1();
    showPage("block1result");
  });

  // Переход ко второму блоку
  btnGoBlock2.addEventListener("click", () => {
    showPage("block2code");
  });

  // Код доступа второй блок
  inputCodeBlock2.addEventListener("input", () => {
    if(inputCodeBlock2.value.trim() === codeBlock2) {
      btnStartBlock2.disabled = false;
      errorCodeBlock2.textContent = "";
    } else {
      btnStartBlock2.disabled = true;
    }
  });

  btnStartBlock2.addEventListener("click", () => {
    if(inputCodeBlock2.value.trim() === codeBlock2) {
      errorCodeBlock2.textContent = "";
      showPage("block2test");
      // Рендерим вопросы второго блока
      renderQuestions("history", historyDiv);
      renderQuestions("eng", engDiv);
      // Настраиваем табы второго блока
      setupTabs(tabButtonsBlock2, [historyDiv, engDiv]);
      // По умолчанию показываем историю
      tabButtonsBlock2.forEach(b => b.disabled = false);
      tabButtonsBlock2[0].disabled = true;
      historyDiv.classList.remove("hidden");
      engDiv.classList.add("hidden");
      currentSubject = "history";
    } else {
      errorCodeBlock2.textContent = "Невірний код доступу";
    }
  });

  // Завершить тестирование второго блока
  btnFinishBlock2.addEventListener("click", () => {
    confirmFinishBlock2.classList.remove("hidden");
  });

  confirmNoBlock2.addEventListener("click", () => {
    confirmFinishBlock2.classList.add("hidden");
  });

  confirmYesBlock2.addEventListener("click", () => {
    confirmFinishBlock2.classList.add("hidden");
    showResultsBlock2();
    showPage("block2result");
  });

  // Просмотр ответов
  btnViewAnswers.addEventListener("click", () => {
    showAllAnswers();
    showPage("answers");
  });

  // Перезапуск теста
  btnRestart.addEventListener("click", () => {
    location.reload();
  });

  // Начинаем с показа стартовой страницы
  showPage("start");

</script>

</body>
</html>
