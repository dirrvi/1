<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <title>Тестування по 4 предметам</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; background: #f7f7f7; }
    button { padding: 10px 20px; margin: 5px; cursor: pointer; }
    .hidden { display: none; }
    .tabs {
      display: flex;
      margin-bottom: 10px;
    }
    .tab {
      padding: 10px 20px;
      border: 1px solid #ccc;
      border-bottom: none;
      background: #eee;
      cursor: pointer;
      user-select: none;
      margin-right: 5px;
      border-radius: 5px 5px 0 0;
    }
    .tab.active {
      background: white;
      font-weight: bold;
      border-bottom: 1px solid white;
    }
    .tab-content {
      border: 1px solid #ccc;
      background: white;
      padding: 15px;
      border-radius: 0 5px 5px 5px;
    }
    .question {
      margin-bottom: 15px;
    }
    .question p {
      font-weight: bold;
    }
    label {
      display: block;
      margin-left: 20px;
      cursor: pointer;
    }
    table.results-table {
      border-collapse: collapse;
      width: 100%;
      margin-top: 20px;
      background: white;
    }
    .results-table th, .results-table td {
      border: 1px solid #ddd;
      padding: 8px;
      background-color: white; /* белый фон по умолчанию */
    }
    .results-table td.col3-green {
      background-color: #c6efce; /* светло-зеленый фон */
      color: #006100; /* темно-зеленый текст */
      font-weight: bold;
    }
    .answer-review {
      margin-top: 20px;
      background: white;
      padding: 15px;
      border-radius: 5px;
      max-height: 400px;
      overflow-y: auto;
      border: 1px solid #ccc;
    }
    .answer-review h3 {
      margin-top: 0;
    }
  </style>
</head>
<body>

  <!-- Страницы -->
  <div id="page-rules">
    <h1>Правила тестування</h1>
    <p>Ознайомтесь із правилами перед початком тесту.</p>
    <ul>
      <li>Тест складається з двох блоків: 1 блок — Українська мова і Математика, 2 блок — Історія України і Англійська мова.</li>
      <li>Відповіді зберігаються автоматично.</li>
      <li>Після завершення блоку ви побачите результати.</li>
    </ul>
    <button id="btn-accept-rules">З правилами ознайомився/лась</button>
  </div>

  <div id="page-block1code" class="hidden">
    <h2>Введіть код доступу для першого блоку</h2>
    <input type="text" id="input-block1code" placeholder="Код доступу" />
    <button id="btn-start-block1">Розпочати роботу над тестуванням</button>
    <p id="error-block1code" style="color:red;"></p>
  </div>

  <div id="page-block1start" class="hidden">
    <button id="btn-go-test1">Перейти до тесту першого блоку</button>
  </div>

  <div id="page-block1test" class="hidden">
    <div class="tabs">
      <div class="tab active" data-subject="ukr">Українська мова</div>
      <div class="tab" data-subject="math">Математика</div>
    </div>
    <div id="tab-ukr" class="tab-content"></div>
    <div id="tab-math" class="tab-content hidden"></div>
    <button id="btn-finish-block1">Завершити тестування</button>
  </div>

  <div id="confirm-finish-block1" class="hidden">
    <p>Ви точно хочете завершити роботу над тестуванням?</p>
    <button id="btn-confirm-finish-block1">Завершити</button>
    <button id="btn-cancel-finish-block1">Відміна</button>
  </div>

  <div id="page-block1result" class="hidden"></div>

  <div id="page-block2code" class="hidden">
    <h2>Введіть код доступу для другого блоку</h2>
    <input type="text" id="input-block2code" placeholder="Код доступу" />
    <button id="btn-start-block2">Розпочати роботу над тестуванням</button>
    <p id="error-block2code" style="color:red;"></p>
  </div>

  <div id="page-block2start" class="hidden">
    <button id="btn-go-test2">Перейти до тесту другого блоку</button>
  </div>

  <div id="page-block2test" class="hidden">
    <div class="tabs">
      <div class="tab active" data-subject="history">Історія України</div>
      <div class="tab" data-subject="eng">Англійська мова</div>
    </div>
    <div id="tab-history" class="tab-content"></div>
    <div id="tab-eng" class="tab-content hidden"></div>
    <button id="btn-finish-block2">Завершити тестування</button>
  </div>

  <div id="confirm-finish-block2" class="hidden">
    <p>Ви точно хочете завершити роботу над тестуванням?</p>
    <button id="btn-confirm-finish-block2">Завершити</button>
    <button id="btn-cancel-finish-block2">Відміна</button>
  </div>

  <div id="page-block2result" class="hidden"></div>

  <div id="page-answers" class="hidden">
    <h2>Відповіді на всі тести</h2>
    <div id="answers-container" class="answer-review"></div>
    <button id="btn-restart">Почати заново</button>
  </div>

<script>
  // Вопросы по предметам (12 вопросов каждый)
  const questions = {
    ukr: [
      { q: "Яка частина мови означає дію?", options: ["Іменник", "Дієслово", "Прикметник", "Прислівник"], a: 1 },
      { q: "Обери правильне речення.", options: ["Я іду в школу.", "Я йду в школу.", "Я іду на школу.", "Я йду на школу."], a: 1 },
      { q: "Вкажіть синонім до слова 'великий'.", options: ["Малий", "Величезний", "Мокрий", "Сухий"], a: 1 },
      { q: "Який знак ставиться в кінці розповідного речення?", options: [".", "?", "!", ","], a: 0 },
      { q: "Який відмінок має слово в реченні: 'Книга лежить на столі'?", options: ["Називний", "Родовий", "Місцевий", "Знахідний"], a: 2 },
      { q: "Обери правильне написання.", options: ["Вчора", "Вчера", "Вчіра", "Вчір"], a: 0 },
      { q: "Що є основою слова?", options: ["Корінь", "Приставка", "Закінчення", "Префікс"], a: 0 },
      { q: "Яке слово є прикметником?", options: ["Швидко", "Швидкий", "Швидкість", "Швидше"], a: 1 },
      { q: "Виберіть правильний спосіб писати речення.", options: ["Сьогодні гарна погода.", "Сьогодні гарна погода!", "Сьогодні, гарна погода.", "Сьогодні гарна погода?"], a: 0 },
      { q: "Яка частина мови відповідає на питання 'хто? що?'", options: ["Дієслово", "Іменник", "Прикметник", "Прислівник"], a: 1 },
      { q: "Обери слово з наголосом на другому складі.", options: ["Молоко", "Вода", "Дорога", "Писати"], a: 0 },
      { q: "Що таке антоніми?", options: ["Слова з однаковим значенням", "Слова з протилежним значенням", "Слова з різним значенням", "Слова з однаковим звучанням"], a: 1 },
    ],
    math: [
      { q: "Що таке сума чисел 5 і 3?", options: ["8", "15", "53", "7"], a: 0 },
      { q: "Обери правильний результат: 7 - 4 = ?", options: ["3", "4", "2", "1"], a: 0 },
      { q: "Яке число є парним?", options: ["3", "5", "8", "7"], a: 2 },
      { q: "Що таке добуток 2 і 6?", options: ["12", "8", "6", "14"], a: 0 },
      { q: "Обери правильне число: квадратний корінь з 9?", options: ["3", "9", "81", "6"], a: 0 },
      { q: "Що таке частка чисел 20 і 4?", options: ["5", "16", "24", "6"], a: 0 },
      { q: "Як називається кут у 90 градусів?", options: ["Гострий", "Тупий", "Прямий", "Розгорнутий"], a: 2 },
      { q: "Обери правильне твердження: число 0 є ...", options: ["Позитивним", "Негативним", "Нулем", "Дробом"], a: 2 },
      { q: "Обери правильний результат: 10 : 2 = ?", options: ["5", "8", "2", "12"], a: 0 },
      { q: "Скільки буде 4 + 4 + 4?", options: ["12", "8", "16", "10"], a: 0 },
      { q: "Що таке периметр квадрата зі стороною 3?", options: ["9", "6", "12", "3"], a: 2 },
      { q: "Обери число, яке є простим:", options: ["4", "6", "7", "9"], a: 2 },
    ],
    history: [
      { q: "Коли почалася Друга світова війна?", options: ["1939", "1914", "1945", "1920"], a: 0 },
      { q: "Хто був першим президентом України?", options: ["Віктор Ющенко", "Леонід Кравчук", "Петро Порошенко", "Володимир Зеленський"], a: 1 },
      { q: "Яка подія відбулася у 1991 році?", options: ["Революція Гідності", "Незалежність України", "Київська Русь", "Перша світова війна"], a: 1 },
      { q: "Який відомий козацький гетьман?", options: ["Богдан Хмельницький", "Іван Мазепа", "Тарас Шевченко", "Микола Гоголь"], a: 0 },
      { q: "Що таке Київська Русь?", options: ["Держава", "Місто", "Річка", "Гора"], a: 0 },
      { q: "Хто написав 'Історію Русів'?", options: ["Нестор", "Михайло Грушевський", "Іван Франко", "Леся Українка"], a: 1 },
      { q: "Коли відбулася революція Гідності?", options: ["2013-2014", "1991", "2004", "2010"], a: 0 },
      { q: "Що означає термін 'Голодомор'?", options: ["Голод", "Війна", "Революція", "Свято"], a: 0 },
      { q: "Хто був першим космонавтом України?", options: ["Юрій Гагарін", "Леонід Каденюк", "Ігор Сікорський", "Василь Ломаченко"], a: 1 },
      { q: "Яке місто є столицею України?", options: ["Львів", "Одеса", "Київ", "Харків"], a: 2 },
      { q: "Хто очолив Україну у 2019 році?", options: ["Петро Порошенко", "Володимир Зеленський", "Юлія Тимошенко", "Віктор Янукович"], a: 1 },
      { q: "Яка мова є державною в Україні?", options: ["Російська", "Українська", "Англійська", "Польська"], a: 1 },
    ],
    eng: [
      { q: "How do you say 'Привіт' in English?", options: ["Hi", "Bye", "Thanks", "Please"], a: 0 },
      { q: "What is the plural of 'cat'?", options: ["cats", "cat", "cates", "cat's"], a: 0 },
      { q: "Choose the correct sentence.", options: ["I is happy.", "I am happy.", "I are happy.", "I be happy."], a: 1 },
      { q: "What is the past tense of 'go'?", options: ["goed", "went", "gone", "going"], a: 1 },
      { q: "Which word is a color?", options: ["Table", "Red", "Run", "Jump"], a: 1 },
      { q: "What does 'apple' mean?", options: ["Fruit", "Car", "House", "Book"], a: 0 },
      { q: "How do you spell the number 4?", options: ["for", "four", "fore", "fur"], a: 1 },
      { q: "Choose the correct question word.", options: ["Where", "Who", "When", "All"], a: 3 },
      { q: "How do you greet someone?", options: ["Hello", "Goodbye", "Sorry", "Thanks"], a: 0 },
      { q: "What is the opposite of 'big'?", options: ["small", "large", "tall", "long"], a: 0 },
      { q: "Select the correct article for 'apple'.", options: ["a", "an", "the", "no article"], a: 1 },
      { q: "What is the meaning of 'book'?", options: ["Something to read", "Something to eat", "Something to write", "Something to wear"], a: 0 },
    ]
  };

  // Коды доступа
  const ACCESS_CODES = {
    block1: "54",
    block2: "29"
  };

  // Хранение ответов по предметам
  let answers = {
    ukr: Array(questions.ukr.length).fill(null),
    math: Array(questions.math.length).fill(null),
    history: Array(questions.history.length).fill(null),
    eng: Array(questions.eng.length).fill(null),
  };

  // Текущий блок и предмет
  let currentBlock = 0; // 1 или 2
  let currentSubject = "";

  // Функция отрисовки вопросов в заданном контейнере
  function renderQuestions(subject, containerId) {
    const container = document.getElementById(containerId);
    container.innerHTML = "";
    questions[subject].forEach((item, i) => {
      const qDiv = document.createElement("div");
      qDiv.className = "question";

      const qP = document.createElement("p");
      qP.textContent = `${i + 1}. ${item.q}`;
      qDiv.appendChild(qP);

      item.options.forEach((opt, idx) => {
        const label = document.createElement("label");
        const input = document.createElement("input");
        input.type = "radio";
        input.name = `${subject}-q${i}`;
        input.value = idx;
        if (answers[subject][i] === idx) {
          input.checked = true;
        }
        input.addEventListener("change", () => {
          answers[subject][i] = idx;
        });
        label.appendChild(input);
        label.appendChild(document.createTextNode(opt));
        qDiv.appendChild(label);
      });

      container.appendChild(qDiv);
    });
  }

  // Функция переключения табов
  function setupTabs(blockNum) {
    const tabs = document.querySelectorAll(`#page-block${blockNum}test .tab`);
    tabs.forEach(tab => {
      tab.addEventListener("click", () => {
        // Снимаем активность
        tabs.forEach(t => t.classList.remove("active"));
        tab.classList.add("active");
        // Скрываем все контенты
        const tabContents = document.querySelectorAll(`#page-block${blockNum}test .tab-content`);
        tabContents.forEach(tc => tc.classList.add("hidden"));
        // Показываем нужный
        const subj = tab.dataset.subject;
        document.getElementById(`tab-${subj}`).classList.remove("hidden");
        currentSubject = subj;
      });
    });
  }

  // Проверка кода доступа
  function checkCode(blockNum, code) {
    return ACCESS_CODES[`block${blockNum}`] === code.trim();
  }

  // Подсчёт результатов по предмету
  function countResults(subject) {
    const corrects = questions[subject].reduce((acc, item, i) => {
      if (answers[subject][i] === item.a) return acc + 1;
      return acc;
    }, 0);
    return corrects;
  }

  // Генерация таблицы с результатами
  function generateResultTable(blockNum) {
    let html = "<h2>Результати тестування</h2>";
    html += "<table class='results-table'><thead><tr>";
    if (blockNum === 1) {
      html += "<th>Предмет</th><th>Правильних відповідей</th><th>Максимальна кількість</th>";
      const ukrScore = countResults("ukr");
      const mathScore = countResults("math");
      html += `<tr><td>Українська мова</td><td>${ukrScore}</td><td>${questions.ukr.length}</td></tr>`;
      // Подсветка - 3 колонка зелёная (у блока 1 3я колонка зелёная?)
      // По условию: во 2 блоке 3 колонка зелёная, в 1-м белая. Поэтому оставим белый.
      html += `<tr><td>Математика</td><td>${mathScore}</td><td>${questions.math.length}</td></tr>`;
    } else {
      html += "<th>Предмет</th><th>Максимальна кількість</th><th>Правильних відповідей</th>";
      // Здесь третий столбец зелёный
      const historyScore = countResults("history");
      const engScore = countResults("eng");
      html += `<tr><td>Історія України</td><td>${questions.history.length}</td><td class='col3-green'>${historyScore}</td></tr>`;
      html += `<tr><td>Англійська мова</td><td>${questions.eng.length}</td><td class='col3-green'>${engScore}</td></tr>`;
    }
    html += "</table>";

    html += `<button id="btn-show-answers">Переглянути відповіді</button>`;
    return html;
  }

  // Показать ответы по всем предметам
  function showAnswers() {
    let html = "";
    ["ukr", "math", "history", "eng"].forEach(subject => {
      html += `<h3>${subjectName(subject)}</h3>`;
      questions[subject].forEach((item, i) => {
        const userAns = answers[subject][i];
        const correctAns = item.a;
        const correctText = item.options[correctAns];
        const userText = userAns !== null ? item.options[userAns] : "Не обрано";
        const isCorrect = userAns === correctAns;
        html += `<p><b>Питання ${i + 1}:</b> ${item.q}<br>`;
        html += `Ваш вибір: <span style="color:${isCorrect ? 'green' : 'red'}">${userText}</span><br>`;
        html += `Правильна відповідь: <b>${correctText}</b></p>`;
      });
    });
    document.getElementById("answers-container").innerHTML = html;
    showPage("page-answers");
  }

  // Возвращает название предмета для заголовков
  function subjectName(subj) {
    switch(subj) {
      case "ukr": return "Українська мова";
      case "math": return "Математика";
      case "history": return "Історія України";
      case "eng": return "Англійська мова";
    }
  }

  // Показать одну страницу, скрыть остальные
  function showPage(id) {
    document.querySelectorAll("body > div").forEach(div => {
      if (div.id === id) div.classList.remove("hidden");
      else div.classList.add("hidden");
    });
  }

  // Инициализация
  function init() {
    showPage("page-rules");

    // Правила
    document.getElementById("btn-accept-rules").onclick = () => {
      showPage("page-block1code");
    };

    // Проверка кода первого блока
    document.getElementById("btn-start-block1").onclick = () => {
      const code = document.getElementById("input-block1code").value;
      if (checkCode(1, code)) {
        document.getElementById("error-block1code").textContent = "";
        showPage("page-block1start");
        currentBlock = 1;
      } else {
        document.getElementById("error-block1code").textContent = "Невірний код доступу!";
      }
    };

    // Переход к тесту блока 1
    document.getElementById("btn-go-test1").onclick = () => {
      showPage("page-block1test");
      renderQuestions("ukr", "tab-ukr");
      renderQuestions("math", "tab-math");
      setupTabs(1);
      currentSubject = "ukr";
    };

    // Завершение блока 1 - кнопка
    document.getElementById("btn-finish-block1").onclick = () => {
      showPage("confirm-finish-block1");
    };

    // Подтверждение завершения блока 1
    document.getElementById("btn-confirm-finish-block1").onclick = () => {
      const resultDiv = document.getElementById("page-block1result");
      resultDiv.innerHTML = generateResultTable(1);
      showPage("page-block1result");

      document.getElementById("btn-show-answers").onclick = () => {
        showAnswers();
      };

      // После первого блока показываем код для второго
      setTimeout(() => {
        showPage("page-block2code");
      }, 3000);
    };

    // Отмена завершения блока 1
    document.getElementById("btn-cancel-finish-block1").onclick = () => {
      showPage("page-block1test");
    };

    // Проверка кода второго блока
    document.getElementById("btn-start-block2").onclick = () => {
      const code = document.getElementById("input-block2code").value;
      if (checkCode(2, code)) {
        document.getElementById("error-block2code").textContent = "";
        showPage("page-block2start");
        currentBlock = 2;
      } else {
        document.getElementById("error-block2code").textContent = "Невірний код доступу!";
      }
    };

    // Переход к тесту блока 2
    document.getElementById("btn-go-test2").onclick = () => {
      showPage("page-block2test");
      renderQuestions("history", "tab-history");
      renderQuestions("eng", "tab-eng");
      setupTabs(2);
      currentSubject = "history";
    };

    // Завершение блока 2 - кнопка
    document.getElementById("btn-finish-block2").onclick = () => {
      showPage("confirm-finish-block2");
    };

    // Подтверждение завершения блока 2
    document.getElementById("btn-confirm-finish-block2").onclick = () => {
      const resultDiv = document.getElementById("page-block2result");
      resultDiv.innerHTML = generateResultTable(2);
      showPage("page-block2result");

      document.getElementById("btn-show-answers").onclick = () => {
        showAnswers();
      };
    };

    // Отмена завершения блока 2
    document.getElementById("btn-cancel-finish-block2").onclick = () => {
      showPage("page-block2test");
    };

    // Кнопка Переглянути відповіді
    // Уже обработана в generateResultTable, назначается при показе результатов

    // Кнопка начать заново на странице ответов
    document.getElementById("btn-restart").onclick = () => {
      answers = {
        ukr: Array(questions.ukr.length).fill(null),
        math: Array(questions.math.length).fill(null),
        history: Array(questions.history.length).fill(null),
        eng: Array(questions.eng.length).fill(null),
      };
      currentBlock = 0;
      currentSubject = "";
      document.getElementById("input-block1code").value = "";
      document.getElementById("input-block2code").value = "";
      showPage("page-rules");
    };
  }

  init();

</script>

</body>
</html>
