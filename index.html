<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Тестування</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0; padding: 0;
      background: #f4f4f4;
      color: #000;
    }
    .page {
      max-width: 900px;
      margin: 30px auto;
      padding: 20px;
      background: #fff;
      border-radius: 5px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    button {
      padding: 10px 20px;
      font-size: 16px;
      margin-top: 15px;
      cursor: pointer;
    }
    .tabs {
      display: flex;
      margin-bottom: 10px;
      user-select: none;
    }
    .tab {
      padding: 10px 15px;
      background: #ddd;
      margin-right: 10px;
      cursor: pointer;
      border-radius: 3px 3px 0 0;
    }
    .tab.active {
      background: #bbb;
      font-weight: bold;
    }
    .tab-content {
      border: 1px solid #bbb;
      padding: 15px;
      border-radius: 0 3px 3px 3px;
      background: #fff;
      max-height: 600px;
      overflow-y: auto;
    }
    .question {
      margin-bottom: 20px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 8px;
      text-align: center;
      background: #fff;
    }
    .col3-green {
      background-color: #c9f7c2 !important;
    }
    .answer-correct {
      color: green;
      font-weight: bold;
    }
    .answer-wrong {
      color: red;
      font-weight: bold;
    }
  </style>
</head>
<body>

<div id="app" class="page"></div>

<script>
(() => {
  // Дані з 12 питаннями на предмет
  const questions = {
    "Українська мова": [
      { question: "Обери правильне твердження про українську мову.", options: ["Це слов'янська мова", "Це романська мова", "Це германська мова", "Це мова з Африки"], correct: 0 },
      { question: "Яке слово є іменником?", options: ["Бігати", "Красивий", "Дім", "Швидко"], correct: 2 },
      { question: "Обери слово з наголосом на другому складі.", options: ["Мо́локо", "Город", "Дерево", "Книга"], correct: 0 },
      { question: "Вибери правильно написане слово.", options: ["Пишемо", "Пишемо", "Пишемо", "Пишемо"], correct: 0 },
      { question: "Доберіть значення іншомовного слова 'комп'ютер'.", options: ["Обчислювальна машина", "Телефон", "Письмовий прилад", "Музичний інструмент"], correct: 0 },
      { question: "Який розділ мови вивчає слова?", options: ["Лексикологія", "Морфологія", "Синтаксис", "Фонетика"], correct: 0 },
      { question: "Що означає слово 'письменник'?", options: ["Той, хто пише", "Той, хто читає", "Той, хто малює", "Той, хто співає"], correct: 0 },
      { question: "Обери прикметник серед слів.", options: ["Великий", "Ходити", "Птах", "Море"], correct: 0 },
      { question: "Що таке синонім?", options: ["Слова однакового значення", "Слова з протилежним значенням", "Прислівники", "Сполучники"], correct: 0 },
      { question: "В якому реченні є звертання?", options: ["Привіт, друже!", "Я йду до школи.", "Падає дощ.", "Сонце світить."], correct: 0 },
      { question: "Обери правильний варіант закінчення.", options: ["Я люблю читати", "Я любити читати", "Я люблю читання", "Я любиш читати"], correct: 0 },
      { question: "Що означає слово 'рідний'?", options: ["Близький", "Далекий", "Незнайомий", "Чужий"], correct: 0 }
    ],
    "Математика": [
      { question: "Скільки буде 7 + 8?", options: ["15", "16", "17", "14"], correct: 0 },
      { question: "Яке число є парним?", options: ["3", "7", "10", "5"], correct: 2 },
      { question: "Що таке периметр квадрата зі стороною 4?", options: ["16", "8", "12", "4"], correct: 0 },
      { question: "Яке число менше за 5?", options: ["6", "7", "3", "8"], correct: 2 },
      { question: "Обчисліть: 9 - 4 = ?", options: ["5", "6", "4", "3"], correct: 0 },
      { question: "Який результат множення 3 * 3?", options: ["6", "9", "12", "8"], correct: 1 },
      { question: "Що таке добуток?", options: ["Результат множення", "Результат ділення", "Результат додавання", "Результат віднімання"], correct: 0 },
      { question: "Яке число є простим?", options: ["4", "9", "7", "6"], correct: 2 },
      { question: "Обчисліть 12 / 3.", options: ["3", "4", "6", "5"], correct: 1 },
      { question: "Що таке кут прямий?", options: ["90 градусів", "45 градусів", "180 градусів", "60 градусів"], correct: 0 },
      { question: "Що більше: 1/2 чи 1/3?", options: ["1/3", "1/2", "Вони рівні", "Немає правильного"], correct: 1 },
      { question: "Скільки буде 5 + 7 - 4?", options: ["8", "6", "7", "5"], correct: 0 }
    ],
    "Історія України": [
      { question: "Коли почалась Київська Русь?", options: ["IX ст.", "XII ст.", "XV ст.", "XVII ст."], correct: 0 },
      { question: "Хто був першим президентом України?", options: ["Кравчук", "Ющенко", "Янукович", "Порошенко"], correct: 0 },
      { question: "Яка подія відбулась у 1991 році?", options: ["Незалежність України", "Друга світова війна", "Революція Гідності", "Перший космонавт"], correct: 0 },
      { question: "Столиця України?", options: ["Київ", "Львів", "Харків", "Одеса"], correct: 0 },
      { question: "Що таке Майдан?", options: ["Площа для зборів", "Вид спорту", "Свято", "Річка"], correct: 0 },
      { question: "Хто очолював Україну у 2014 році?", options: ["Порошенко", "Кучма", "Кравчук", "Ющенко"], correct: 0 },
      { question: "Коли почалась Друга світова війна?", options: ["1939", "1945", "1914", "1920"], correct: 0 },
      { question: "Який гетьман очолював Військо Запорозьке?", options: ["Богдан Хмельницький", "Іван Мазепа", "Пилип Орлик", "Сагайдачний"], correct: 0 },
      { question: "Що таке Голодомор?", options: ["Геноцид українського народу", "Свято урожаю", "Військова операція", "Історичний роман"], correct: 0 },
      { question: "Яка річка найдовша в Україні?", options: ["Дніпро", "Прут", "Дністер", "Тиса"], correct: 0 },
      { question: "Хто є автором Конституції України?", options: ["Пилип Орлик", "Тарас Шевченко", "Іван Франко", "Леся Українка"], correct: 0 },
      { question: "Коли відбулась Помаранчева революція?", options: ["2004", "2010", "1991", "2014"], correct: 0 }
    ],
    "Англійська мова": [
      { question: "How do you say 'cat' in Ukrainian?", options: ["Кіт", "Пес", "Кінь", "Корова"], correct: 0 },
      { question: "What is the past tense of 'go'?", options: ["Went", "Goed", "Go", "Gone"], correct: 0 },
      { question: "Choose the correct article: ___ apple.", options: ["An", "A", "The", "No article"], correct: 0 },
      { question: "What is 'яблуко' in English?", options: ["Apple", "Orange", "Banana", "Grape"], correct: 0 },
      { question: "Select the plural form of 'child'.", options: ["Childs", "Children", "Childes", "Child"], correct: 1 },
      { question: "How do you spell the number 5?", options: ["Five", "Fife", "Fiev", "Fiv"], correct: 0 },
      { question: "What is the opposite of 'hot'?", options: ["Cold", "Warm", "Cool", "Wet"], correct: 0 },
      { question: "Which one is a fruit?", options: ["Carrot", "Apple", "Potato", "Cabbage"], correct: 1 },
      { question: "How do you greet someone?", options: ["Hello", "Goodbye", "Thanks", "Sorry"], correct: 0 },
      { question: "What color is the sky?", options: ["Blue", "Green", "Red", "Yellow"], correct: 0 },
      { question: "What day comes after Monday?", options: ["Tuesday", "Sunday", "Friday", "Saturday"], correct: 0 },
      { question: "How many legs does a spider have?", options: ["Six", "Eight", "Four", "Ten"], correct: 1 }
    ],
  };

  // Стан програми
  const state = {
    page: "rules", // rules, access, test, blockResult, showAnswers
    block: 1,
    subjectIndex: 0,
    answers: {
      "Українська мова": Array(12).fill(null),
      "Математика": Array(12).fill(null),
      "Історія України": Array(12).fill(null),
      "Англійська мова": Array(12).fill(null),
    }
  };

  const subjectsBlock1 = ["Українська мова", "Математика"];
  const subjectsBlock2 = ["Історія України", "Англійська мова"];

  const app = document.getElementById("app");

  function render() {
    if(state.page === "rules") {
      app.innerHTML = `
        <h1>Вітаємо в тестуванні!</h1>
        <p>Інструкції:</p>
        <ul>
          <li>Введіть код доступу (вам його повідомить вчитель) для початку блоку тестів.</li>
          <liВідповідайте на всі питання у блоці, відповіді зберігаються автоматично.</li>
          <li>Після завершення блоку натисніть кнопку "Завершити блок".</li>
          <li>Після першого блоку буде запит коду доступу до другого блоку.</li>
          <li>Після другого блоку з'явиться можливість переглянути свої відповіді та помилки.</li>
        </ul>
        <button onclick="startAccess()">Почати блок 1</button>
      `;
    } else if(state.page === "access") {
      // Старт блоку тестів — вводимо код (надписи убрал)
      app.innerHTML = `
        <h2>Введіть код доступу для блоку ${state.block}</h2>
        <input id="accessCode" type="password" autofocus />
        <button onclick="checkAccess()">Почати тест</button>
      `;
      setTimeout(() => {
        const inp = document.getElementById("accessCode");
        if(inp) inp.focus();
      }, 50);
    } else if(state.page === "test") {
      // Виводимо всі питання блоку (по 12 в кожному предметі)
      const subjects = state.block === 1 ? subjectsBlock1 : subjectsBlock2;
      let tabs = "";
      let tabContents = "";
      subjects.forEach((subj, i) => {
        tabs += `<div class="tab ${i === state.subjectIndex ? "active" : ""}" onclick="switchTab(${i})">${subj}</div>`;
        let questionsHtml = "";
        questions[subj].forEach((q, idx) => {
          const ans = state.answers[subj][idx];
          questionsHtml += `
            <div class="question">
              <p><b>Питання ${idx + 1}:</b> ${q.question}</p>
              ${q.options.map((opt, oi) => `
                <label>
                  <input type="radio" name="q_${subj}_${idx}" value="${oi}" ${ans === oi ? "checked" : ""} onchange="saveAnswer('${subj}', ${idx}, ${oi})" />
                  ${opt}
                </label><br />
              `).join("")}
            </div>
          `;
        });
        tabContents += `<div class="tab-content" style="display: ${i === state.subjectIndex ? "block" : "none"}">${questionsHtml}</div>`;
      });
      app.innerHTML = `
        <h2>Блок ${state.block} — відповіді на питання</h2>
        <div class="tabs">${tabs}</div>
        ${tabContents}
        <button onclick="finishBlock()">Завершити блок</button>
      `;
    } else if(state.page === "blockResult") {
      // Показати таблицю результатів для першого або другого блоку
      let rows = "";
      const allSubjects = ["Українська мова", "Математика", "Історія України", "Англійська мова"];
      allSubjects.forEach(subj => {
        const ansCount = state.answers[subj].filter(a => a !== null).length;
        let col3 = "";
        if(state.block === 1) {
          col3 = subj === "Українська мова" || subj === "Математика" ? "" : "До виконання не приступив";
        } else if(state.block === 2) {
          const correctCount = questions[subj].reduce((acc, q, i) => acc + (state.answers[subj][i] === q.correct ? 1 : 0), 0);
          col3 = `Правильних відповідей: ${correctCount} / 12`;
        }
        rows += `
          <tr>
            <td>${subj}</td>
            <td>${ansCount} / 12</td>
            <td class="${state.block === 2 ? 'col3-green' : ''}">${col3}</td>
          </tr>
        `;
      });
      app.innerHTML = `
        <h2>Результати блоку ${state.block}</h2>
        <table>
          <thead><tr><th>Предмет</th><th>Відповіді</th><th>Результат</th></tr></thead>
          <tbody>${rows}</tbody>
        </table>
        ${state.block === 1 ? `<button onclick="goToAccess2()">Перейти до блоку 2</button>` : `<button onclick="showAnswers()">Переглянути відповіді</button>`}
      `;
    } else if(state.page === "showAnswers") {
      let content = `<h2>Перегляд відповідей та помилок</h2>`;
      Object.keys(questions).forEach(subj => {
        content += `<h3>${subj}</h3>`;
        questions[subj].forEach((q, i) => {
          const userAns = state.answers[subj][i];
          const correctAns = q.correct;
          const userText = userAns === null ? "Відповідь відсутня" : q.options[userAns];
          const correctText = q.options[correctAns];
          const className = userAns === correctAns ? "answer-correct" : "answer-wrong";
          content += `
            <p><b>Питання ${i+1}:</b> ${q.question}</p>
            <p>Ваша відповідь: <span class="${className}">${userText}</span></p>
            ${userAns !== correctAns ? `<p>Правильна відповідь: <b>${correctText}</b></p>` : ""}
            <hr>
          `;
        });
      });
      content += `<button onclick="restart()">Почати заново</button>`;
      app.innerHTML = content;
    }
  }

  // --- Функції для керування ---
  window.startAccess = () => {
    state.page = "access";
    render();
  };

  window.checkAccess = () => {
    const inp = document.getElementById("accessCode");
    if (!inp) return;
    const code = inp.value.trim();
    // Коди доступу ж будеш передавати учням окремо, тут просто приймаємо будь-який код і запускаємо
    // Якщо хочеш, можна тут зробити перевірку, але зараз пропускаємо
    if (code.length > 0) {
      state.page = "test";
      render();
    } else {
      alert("Введіть код доступу.");
    }
  };

  window.switchTab = (i) => {
    state.subjectIndex = i;
    render();
  };

  window.saveAnswer = (subject, qIndex, ansIndex) => {
    state.answers[subject][qIndex] = ansIndex;
    render();
  };

  window.finishBlock = () => {
    const subjectsInBlock = state.block === 1 ? subjectsBlock1 : subjectsBlock2;
    for (let subj of subjectsInBlock) {
      if (state.answers[subj].some(a => a === null)) {
        if (!confirm(`У предметі "${subj}" є неотвечені питання. Закінчити блок?`)) {
          return;
        }
      }
    }
    state.page = "blockResult";
    render();
  };

  window.goToAccess2 = () => {
    state.block = 2;
    state.subjectIndex = 0;
    state.page = "access";
    render();
  };

  window.showAnswers = () => {
    state.page = "showAnswers";
    render();
  };

  window.restart = () => {
    state.block = 1;
    state.subjectIndex = 0;
    for (let key in state.answers) {
      state.answers[key] = Array(12).fill(null);
    }
    state.page = "rules";
    render();
  };

  render();
})();
</script>

</body>
</html>
